#pragma once
#pragma warning(disable: 4244) //conversion warnings for int to char in below screen buffers
#pragma warning(disable: 4838)
#pragma warning(disable: 4309)

#include "Network.h"
#include "DeviceComms.h"
#include "TestLoop.h"
#include "Common.h"

static char screen_buffer1[25][81] = {
    "********************************************************************************",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                HELLO WORLD                                   *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "*                                                                              *",
    "********************************************************************************"
};

static char screen_buffer[25][81] = {
    {0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB0,0xB0,0xB0,0xB0,0xB0,0xB0,0xB0,0xB0,0xB0,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xFD,0xFD,0xFD,0xFD,0xFD,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xB1,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0x20,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDE,0x20,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDF,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0xDF,0x20,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0x20,0xDF,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDE,0x20,0x20,0x20,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDF,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0x20,0x20,0xDF,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDF,0x20,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDE,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0xDF,0xDB,0xDB,0xDB,0xDB,0xDE,0x20,0x20,0x31,0x20,0x20,0xE7,0xDB,0xDB,0xDB,0xDB,0xDF,0x20,0x20,0x20,0xDC,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0xDF,0xDB,0xDB,0xDE,0x20,0x20,0x38,0x20,0x20,0xE7,0xDB,0xDB,0xDF,0x20,0x20,0x20,0x20,0xDC,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDC,0x20,0x20,0x20,0x20,0xDB,0xDE,0x20,0x20,0x20,0xE7,0xDB,0x20,0x20,0x20,0x20,0x20,0xDC,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDC,0xDC,0xDF,0xDF,0xDF,0xDF,0xDF,0xDB,0xDB,0xDB,0xDB,0xDC,0x20,0x20,0x20,0x20,0xDB,0x20,0x20,0x20,0xDB,0x20,0x20,0x20,0x20,0xDC,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDF,0xDF,0xDF,0xDF,0x20,0xDC,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDC,0xDC,0x20,0x20,0x20,0x20,0xDF,0xDF,0xDC,0x20,0x20,0x20,0xDE,0x20,0xB0,0x20,0x20,0xDC,0xFE,0xDF,0xDF,0xDF,0x20,0x20,0x20,0x20,0x20,0xDC,0xDB,0xDE,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDC,0xDC,0x20,0x20,0x20,0x20,0xDF,0xFE,0x20,0x20,0x20,0x20,0xFE,0xDF,0x20,0x20,0x20,0x20,0x20,0xDC,0xDC,0xDC,0xDB,0xDB,0xDB,0xDE,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0xFE,0xDF,0xDF,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0xDF,0xDF,0xDB,0xDB,0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDE,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDF,0x20,0x20,0x20,0xDC,0xDC,0xDB,0xDC,0x20,0xDC,0xDB,0xDC,0x20,0x20,0x20,0x20,0xDF,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDF,0xDC,0xDC,0xDC,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDC,0xDC,0xDC,0xDF,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0xE7,0x42,0x41,0x42,0x59,0x4C,0x4F,0x4E,0x20,0x43,0x4F,0x4C,0x54,0x20,0x44,0x45,0x20,0x47,0x41,0x4D,0x45,0xDB,0x20,0xE7,0x57,0x41,0x48,0x20,0x47,0x57,0x41,0x4E,0x20,0x20,0x50,0x52,0x41,0x49,0x53,0x45,0x20,0x4A,0x41,0x48,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x53,0x41,0x55,0x43,0x45,0x30,0x30,0x44,0x41,0x20,0x44,0x49,0x5A,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x77,0x61,0x72,0x70,0x75,0x73,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x4C,0x41,0x5A,0x41,0x52,0x55,0x53,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x32,0x30,0x32,0x34,0x30,0x32,0x30,0x38,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},
    {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00}
};


#ifdef __cplusplus
extern "C" {
#endif

	// Handles a keypad button press from a terminal
	void HandleKeypadPress(int sockfd, char terminalId, char button);

	// Handles a SYSTEM_CMD message (OpOne)
	void HandleOpOne(int sockfd, char* buf, int len);

	// Handles a UNIT_CMD message (OpTwo)
	void HandleOpTwo(int sockfd, char* buf, int len);

	// Main parser for incoming messages
	extern void ParseMessage(int sockfd, char* buf, int len);

#ifdef __cplusplus
}
#endif
